# Node.js
# Build a general Node.js project with npm.
# Add steps that analyze code, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/javascript

trigger:
- master
- dev

jobs:
- job: BuildNodeWorker
  strategy:
    maxParallel: 1
    matrix:
      UBUNTU_NODE8:
        IMAGE_TYPE: 'ubuntu-latest'
        NODE_VERSION: '8.x'
      UBUNTU_NODE10:
        IMAGE_TYPE: 'ubuntu-latest'
        NODE_VERSION: '10.x'
      WINDOWS_NODE8:
        IMAGE_TYPE: 'vs2017-win2016'
        NODE_VERSION: '8.x'
      WINDOWS_NODE10:
        IMAGE_TYPE: 'vs2017-win2016'
        NODE_VERSION: '10.x'
      MAC_NODE8:
        IMAGE_TYPE: 'macos-10.13'
        NODE_VERSION: '8.x'
      MAC_NODE10:
        IMAGE_TYPE: 'macos-10.13'
        NODE_VERSION: '10.x'

  pool:
    vmImage: $(IMAGE_TYPE)

  steps:
  - task: NodeTool@0
    inputs:
      versionSpec: $(NODE_VERSION)
    displayName: 'Install Node.js'

  - script: |
      npm install
      npm run build
    displayName: 'npm install and build'
